SELECT RUT, NOMBRE, TIPO, TOTAL_COMPRADO, TOTAL_VENDIDO
FROM (
    SELECT C.RUTCLIENTE AS RUT, C.NOMBRE AS NOMBRE, 'Cliente' AS TIPO, TO_CHAR(SUM(F.TOTAL), '$999G999G999') AS "TOTAL_COMPRADO"
    FROM CLIENTE C
    LEFT JOIN FACTURA F
    ON C.RUTCLIENTE = F.RUTCLIENTE
    GROUP BY C.RUTCLIENTE, C.NOMBRE 
    UNION ALL
    SELECT V.RUTVENDEDOR AS RUT, V.NOMBRE AS NOMBRE, 'Vendedor(a)' AS TIPO,  TO_CHAR(SUM(FA.TOTAL), '$999G999G999') AS "TOTAL_VENDIDO"
    FROM VENDEDOR V
    LEFT JOIN FACTURA FA ON V.RUTVENDEDOR = FA.RUTVENDEDOR
    GROUP BY V.RUTVENDEDOR, V.NOMBRE
)
GROUP BY RUT, NOMBRE, TIPO
ORDER BY RUT;


SELECT RUT, NOMBRE, TIPO, TOTAL_COMPRADO, TOTAL_VENDIDO
FROM (
    SELECT C.RUTCLIENTE AS RUT, C.NOMBRE AS NOMBRE, 'Cliente' AS TIPO, TO_CHAR(SUM(F.TOTAL), '$999G999G999') AS "TOTAL_COMPRADO", NULL AS TOTAL_VENDIDO
    FROM CLIENTE C
    LEFT JOIN FACTURA F ON C.RUTCLIENTE = F.RUTCLIENTE
    GROUP BY C.RUTCLIENTE, C.NOMBRE 

    UNION ALL

    SELECT V.RUTVENDEDOR AS RUT, V.NOMBRE AS NOMBRE, 'Vendedor(a)' AS TIPO, NULL AS TOTAL_COMPRADO, TO_CHAR(SUM(FA.TOTAL), '$999G999G999') AS "TOTAL_VENDIDO"
    FROM VENDEDOR V
    LEFT JOIN FACTURA FA ON V.RUTVENDEDOR = FA.RUTVENDEDOR
    GROUP BY V.RUTVENDEDOR, V.NOMBRE
)
GROUP BY RUT, NOMBRE, TIPO, TOTAL_COMPRADO, TOTAL_VENDIDO
ORDER BY RUT;


SELECT RUT, NOMBRE, TIPO, TOTAL_COMPRADO, TOTAL_VENDIDO
FROM (
    SELECT C.RUTCLIENTE AS RUT, C.NOMBRE AS NOMBRE, 'Cliente' AS TIPO, TO_CHAR(SUM(F.TOTAL), '$999G999G999') AS "TOTAL_COMPRADO", NULL AS TOTAL_VENDIDO
    FROM CLIENTE C
    LEFT JOIN FACTURA F ON C.RUTCLIENTE = F.RUTCLIENTE
    GROUP BY C.RUTCLIENTE, C.NOMBRE 

    UNION ALL

    SELECT V.RUTVENDEDOR AS RUT, V.NOMBRE AS NOMBRE, 'Vendedor(a)' AS TIPO, NULL AS TOTAL_COMPRADO, TO_CHAR(SUM(FA.TOTAL), '$999G999G999') AS "TOTAL_VENDIDO"
    FROM VENDEDOR V
    LEFT JOIN FACTURA FA ON V.RUTVENDEDOR = FA.RUTVENDEDOR
    GROUP BY V.RUTVENDEDOR, V.NOMBRE
)
GROUP BY RUT, NOMBRE, TIPO, TOTAL_COMPRADO, TOTAL_VENDIDO
ORDER BY RUT;

